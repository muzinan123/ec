(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4691962a"],{c41c:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:function(t){e.dialogVisible2create=!0}}},[e._v(" 创建路由规则 "),a("i",{staticClass:"el-icon-circle-plus"})])],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,fit:""}},[a("el-table-column",{attrs:{prop:"name",label:"名称",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("svg-icon",{staticStyle:{color:"green","margin-right":"10px"},attrs:{"icon-class":"status"}}),a("a",{staticStyle:{color:"blue"},on:{click:function(t){return e.showRuleDetail(l.name)}}},[e._v(" "+e._s(l.name)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"source",label:"路由起点",width:"200"}}),a("el-table-column",{attrs:{prop:"target",label:"路由终点",width:"200"}}),a("el-table-column",{attrs:{prop:"age",label:"创建时间",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:l.createTime,placement:"right-start"}},[a("el-button",{staticStyle:{border:"none",outline:"none"}},[e._v(e._s(e.dateTimeFormat(l.createTime))+" "),a("i",{staticClass:"el-icon-info"})])],1)]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[a("el-dropdown",{staticStyle:{cursor:"pointer"},attrs:{placement:"bottom-start"}},[a("span",{staticClass:"el-dropdown-link"},[a("svg-icon",{attrs:{"icon-class":"3points-vertical"}})],1),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.showRuleDetail(l.name)}}},[e._v("查看")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.deleteRuleView(l.name)}}},[e._v("删除")]),a("el-dropdown-item",[e._v("更新")])],1)],1)]}}])})],1),a("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("span",[e._v("删除路由规则后无法恢复，确定删除？")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.deleteRule}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"路由规则详情",visible:e.dialogVisible2detail,width:"30%"},on:{"update:visible":function(t){e.dialogVisible2detail=t}}},[a("pre",[e._v("      "+e._s(e.detailContent)+"\n    ")])]),a("el-dialog",{attrs:{title:"创建路由规则",visible:e.dialogVisible2create,width:"40%"},on:{"update:visible":function(t){e.dialogVisible2create=t}}},[a("create-dialog",{on:{reload:e.reload}})],1)],1)},i=[],r=(a("e9c4"),a("d3b7"),a("159b"),a("b0c0"),a("16f0"),a("ed08")),s=a("5c96"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"form",attrs:{model:e.form}},[e._l(e.form.properties,(function(t,l){return a("el-form-item",{key:l,attrs:{rules:t.rules,prop:"properties["+l+"].value"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(t.label.title)+" ")]),"text"==t.type?a("el-input",{attrs:{placeholder:t.placeholder},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):"options"==t.type?a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.placeholder},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}},e._l(e.ruleEndpointList,(function(e){return a("el-option",{key:e.metadata.name,attrs:{label:e.metadata.name+"("+e.spec.ruleEndpointType+")",value:e.metadata.name}})})),1):a("el-input",{attrs:{type:"textarea"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}})],1)})),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("立即创建")])],1)],2)],1)},n=[],u={name:"CreateDialog",data:function(){return{ruleEndpointList:[],form:{properties:[{name:"name",type:"text",label:{title:"路由规则名称",desc:"路由规则名称"},value:"",rules:[{required:!0,message:"请输入路由规则名称",trigger:"blur"}],placeholder:"请输入路由规则名称"},{name:"source",type:"options",label:{title:"路由起点",desc:"路由起点"},value:"",rules:[{required:!0,message:"请输入路由起点",trigger:"blur"}],placeholder:"请输入路由起点"},{name:"sourceResource",type:"textarea",label:{title:"路由起点配置信息",desc:"路由起点配置信息"},value:"",rules:[{required:!0,message:"请输入路由起点配置信息",trigger:"blur"}],placeholder:"请输入路由起点配置信息"},{name:"target",type:"options",label:{title:"路由终点",desc:"路由终点"},value:"",rules:[{required:!0,message:"请输入路由终点",trigger:"blur"}],placeholder:"请输入路由终点"},{name:"targetResource",type:"textarea",label:{title:"路由终点配置信息",desc:"路由终点配置信息"},value:"",rules:[{required:!0,message:"请输入路由终点配置信息",trigger:"blur"}],placeholder:"请输入路由终点配置信息"}]}}},created:function(){this.init()},methods:{init:function(){var e=this;this.$store.dispatch("edge-router/getRuleEndPointList").then((function(t){e.ruleEndpointList=t}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var a={};t.form.properties.forEach((function(e,t){try{a[e["name"]]=JSON.parse(e["value"])}catch(l){a[e["name"]]=e["value"]}})),t.$store.dispatch("edge-router/createRule",a).then((function(e){Object(s["Message"])({message:"路由创建成功",type:"success",duration:5e3}),t.$emit("reload")}))}))}}},c=u,d=a("2877"),p=Object(d["a"])(c,o,n,!1,null,"61ed4e04",null),m=p.exports,f={name:"Rule",components:{CreateDialog:m},data:function(){return{dialogVisible2detail:!1,dialogVisible2create:!1,dialogVisible:!1,detailContent:null,list:null}},created:function(){this.getList()},methods:{dateTimeFormat:r["b"],reload:function(){this.dialogVisible2create=!1,this.getList()},showRuleDetail:function(e){var t=this;this.dialogVisible2detail=!0,this.$store.dispatch("edge-router/setRuleName",e),this.$store.dispatch("edge-router/getRuleItem").then((function(e){t.detailContent=JSON.stringify(e,null,4)}))},deleteRuleView:function(e){this.$store.dispatch("edge-router/setRuleName",e),this.dialogVisible=!0},deleteRule:function(){var e=this;this.$store.dispatch("edge-router/deleteRule").then((function(){Object(s["Message"])({message:"删除路由规则成功",type:"success",duration:5e3}),e.dialogVisible=!1,e.getList()}))},handleClose:function(e){this.$confirm("确认删除？").then((function(t){e()})).catch((function(e){}))},getList:function(){var e=this;this.$store.dispatch("edge-router/getRuleList").then((function(t){var a=[];t.forEach((function(e,t){a.push({name:e.metadata.name,createTime:e.metadata.creationTimestamp,source:e.spec.source,sourceResource:e.spec.sourceResource,targetResource:e.spec.targetResource,target:e.spec.target})})),e.list=a}))}}},g=f,h=Object(d["a"])(g,l,i,!1,null,"21f24186",null);t["default"]=h.exports},e9c4:function(e,t,a){var l=a("23e7"),i=a("d066"),r=a("d039"),s=i("JSON","stringify"),o=/[\uD800-\uDFFF]/g,n=/^[\uD800-\uDBFF]$/,u=/^[\uDC00-\uDFFF]$/,c=function(e,t,a){var l=a.charAt(t-1),i=a.charAt(t+1);return n.test(e)&&!u.test(i)||u.test(e)&&!n.test(l)?"\\u"+e.charCodeAt(0).toString(16):e},d=r((function(){return'"\\udf06\\ud834"'!==s("\udf06\ud834")||'"\\udead"'!==s("\udead")}));s&&l({target:"JSON",stat:!0,forced:d},{stringify:function(e,t,a){var l=s.apply(null,arguments);return"string"==typeof l?l.replace(o,c):l}})}}]);