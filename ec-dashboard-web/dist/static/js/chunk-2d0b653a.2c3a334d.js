(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b653a"],{"1d4e":function(e,t,i){"use strict";i.r(t);var l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!0}}},[e._v(" 上传模型 "),i("i",{staticClass:"el-icon-upload"})])],1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,fit:""}},[i("el-table-column",{attrs:{prop:"version",label:"模型版本",width:"200",align:"center"}}),i("el-table-column",{attrs:{prop:"class_names",label:"分类信息",width:"200"}}),i("el-table-column",{attrs:{prop:"file_md5",label:"文件Md5",width:"400",align:"center"}}),i("el-table-column",{attrs:{prop:"file_path",label:"文件保存路径",width:"600",align:"center"}}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.row;return[i("el-dropdown",{staticStyle:{cursor:"pointer"},attrs:{placement:"bottom-start"}},[i("span",{staticClass:"el-dropdown-link"},[i("svg-icon",{attrs:{"icon-class":"3points-vertical"}})],1),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{nativeOn:{click:function(t){return e.distributeModel(l.version)}}},[e._v("模型下发")]),i("el-dropdown-item",{nativeOn:{click:function(t){return e.showDeleteModel(l.version)}}},[e._v("删除")])],1)],1)]}}])})],1),i("el-dialog",{attrs:{title:"模型下发",visible:e.dialogVisible2distribute,width:"30%"},on:{"update:visible":function(t){e.dialogVisible2distribute=t}}}),i("el-dialog",{attrs:{title:"上传模型",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{prop:"version.value"}},[i("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(e.form.version.label.title)+" "),i("el-tooltip",{attrs:{placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[e._v(" "+e._s(e.form.version.label.desc)+" ")]),i("i",{staticClass:"el-icon-question"})])],1),i("el-input",{attrs:{placeholder:e.form.version.placeholder},model:{value:e.form.version.value,callback:function(t){e.$set(e.form.version,"value",t)},expression:"form.version.value"}})],1),i("el-form-item",{attrs:{prop:"class_names.value"}},[i("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(e.form.class_names.label.title)+" "),i("el-tooltip",{attrs:{placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[e._v(" "+e._s(e.form.class_names.label.desc)+" ")]),i("i",{staticClass:"el-icon-question"})])],1),i("el-input",{attrs:{placeholder:e.form.class_names.placeholder},model:{value:e.form.class_names.value,callback:function(t){e.$set(e.form.class_names,"value",t)},expression:"form.class_names.value"}})],1),i("el-form-item",{attrs:{prop:"file.value"}},[i("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(e.form.file.label.title)+" "),i("el-tooltip",{attrs:{placement:"right"}},[i("div",{attrs:{slot:"content"},slot:"content"},[e._v(" "+e._s(e.form.file.label.desc)+" ")]),i("i",{staticClass:"el-icon-question"})])],1),i("input",{attrs:{type:"file"},on:{change:function(t){return e.triggerFile(t)}}})])],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("确 定")])],1)],1),i("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible2Delete,width:"30%"},on:{"update:visible":function(t){e.dialogVisible2Delete=t}}},[i("span",[e._v("删除以后AI模型无法恢复，确定删除？")]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible2Delete=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.deleteModel}},[e._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"模型下发",visible:e.dialogVisible2distribute,width:"30%"},on:{"update:visible":function(t){e.dialogVisible2distribute=t}}},[i("distribute-ai-model-dialog")],1)],1)},s=[],a=(i("d3b7"),i("d757")),o=i("5c96"),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-form",{ref:"form",attrs:{model:e.form}},[e._l(e.form.properties,(function(t,l){return i("el-form-item",{key:l,attrs:{rules:t.rules,prop:"properties["+l+"].value"}},[i("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(t.label.title)+" ")]),"text"==t.type?i("el-input",{attrs:{disabled:t.disabled,placeholder:t.placeholder},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}}):"options"==t.type?i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.placeholder},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}},e._l(t.options,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1):i("el-input",{attrs:{type:"textarea"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}})],1)})),e.dialogVisible2progress?i("el-form-item",[i("p",[e._v(e._s(e.distributeStatus))]),i("el-progress",{attrs:{percentage:e.percentage,status:e.progressStatus}})],1):e._e(),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("立即下发")])],1)],2)],1)},n=[],c=(i("159b"),i("b0c0"),"准备开始"),u=0,d={name:"DistributeAiModelDialog",data:function(){return{timer:null,dialogVisible2progress:!1,distributeStatus:c,percentage:u,progressStatus:"",form:{properties:[{name:"version",type:"text",label:{title:"模型版本",desc:"模型版本"},disabled:!0,value:"",rules:[],placeholder:"请输入模型版本"},{name:"node_name",type:"options",label:{title:"边缘节点",desc:"边缘节点"},value:"",options:[],rules:[{required:!0,message:"请选择边缘节点",trigger:"blur"}],disabled:!1,placeholder:"请选择边缘节点"},{name:"rule_name",type:"options",label:{title:"路由规则",desc:"路由规则"},disabled:!1,value:"",options:[],rules:[{required:!0,message:"请选择路由规则",trigger:"blur"}],placeholder:"请选择路由规则"}]}}},created:function(){this.init()},methods:{init:function(){var e=this;this.dialogVisible2progress=!1,this.percentage=u,this.distributeStatus=c,this.$store.dispatch("edge-aimodel/getAiModelVersion").then((function(t){e.form.properties.forEach((function(e,i){"version"===e.name&&(e.value=t)}))})),this.$store.dispatch("edge-router/getRuleList").then((function(t){e.form.properties.forEach((function(e,i){"rule_name"===e.name&&t.forEach((function(t,i){e.options.push(t.metadata.name)}))}))})),this.$store.dispatch("edge-node/getNodeList").then((function(t){e.form.properties.forEach((function(e,i){"node_name"===e.name&&t.forEach((function(t,i){e.options.push(t.metadata.name)}))}))}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var i={};t.form.properties.forEach((function(e,t){try{i[e["name"]]=JSON.parse(e["value"])}catch(l){i[e["name"]]=e["value"]}})),t.$store.dispatch("edge-aimodel/distributeModel",i).then((function(e){var i=e.detail;t.dialogVisible2progress=!0,t.timer=window.setInterval((function(){t.$store.dispatch("edge-aimodel/getDistributeProgress",i).then((function(e){var i=e.detail;if("done"===i)return t.percentage=100,t.distributeStatus="模型下发完毕",t.progressStatus="success",void window.clearInterval(t.timer);isNaN(i)?t.distributeStatus=i:(t.percentage=Math.round(100*parseFloat(i)),t.distributeStatus="模型下发中...")})).catch((function(){window.clearInterval(t.timer)}))}),1e3)}))}))}}},p=d,f=i("2877"),m=Object(f["a"])(p,r,n,!1,null,"101fa8f6",null),b=m.exports,v={name:"AiModel",components:{DistributeAiModelDialog:b},data:function(){return{dialogVisible2distribute:!1,dialogVisible2Delete:!1,dialogVisible:!1,tableData:null,form:{class_names:{label:{title:"分类信息",desc:"分类神经网络分类信息"},value:"",placeholder:"请输入分类信息"},version:{label:{title:"模型版本",desc:"AI模型版本号"},value:"",placeholder:"请输入AI模型版本号"},file:{label:{title:"模型文件",desc:"AI模型文件"},value:""}},rules:{"class_names.value":[{required:!0,message:"请输入模型分类信息",trigger:"blur"}],"version.value":[{required:!0,message:"请输入模型版本号",trigger:"blur"}],"file.value":[{required:!0,message:"请上传模型"}]}}},created:function(){this.getList()},methods:{showDeleteModel:function(e){this.$store.dispatch("edge-aimodel/setAiModelVersion",e),this.dialogVisible2Delete=!0},deleteModel:function(){var e=this;this.$store.dispatch("edge-aimodel/deleteAiModel").then((function(t){Object(o["Message"])({message:"删除AI模型成功",type:"success",duration:5e3}),e.dialogVisible2Delete=!1,e.getList()}))},distributeModel:function(e){this.$store.dispatch("edge-aimodel/setAiModelVersion",e),this.dialogVisible2distribute=!0},handleClose:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},triggerFile:function(e){this.form.file.value=e.target.files[0]},onSubmit:function(e){var t=this;this.$refs[e].validate((function(e){if(e){var i=new FormData;return i.append("file",t.form.file.value),i.append("version",t.form.version.value),i.append("class_names",t.form.class_names.value),new Promise((function(e,l){Object(a["a"])(i).then((function(i){Object(o["Message"])({message:"创建成功",type:"success",duration:5e3}),e(),t.dialogVisible=!1,t.getList()})).catch((function(e){l(e)}))}))}return!1}))},getList:function(){var e=this;this.$store.dispatch("edge-aimodel/getAiModelList").then((function(t){e.tableData=t}))}}},g=v,h=Object(f["a"])(g,l,s,!1,null,"ca2d0252",null);t["default"]=h.exports}}]);