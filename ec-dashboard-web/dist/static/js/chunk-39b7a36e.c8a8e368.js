(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-39b7a36e"],{"2eb5":function(e,t,i){"use strict";i("c84a")},9990:function(e,t,i){"use strict";i("b0ca")},a490:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-button",{staticClass:"filter-item",attrs:{type:"primary"},on:{click:e.createDeviceView}},[e._v(" 创建实例 "),i("i",{staticClass:"el-icon-circle-plus"})])],1),i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,fit:""}},[i("el-table-column",{attrs:{prop:"name",label:"设备名称",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("svg-icon",{staticStyle:{color:"green","margin-right":"10px"},attrs:{"icon-class":"status"}}),i("a",{staticStyle:{color:"blue"},on:{click:function(t){return e.showDeviceDetail(a.name)}}},[e._v(" "+e._s(a.name)+" ")])]}}])}),i("el-table-column",{attrs:{prop:"age",label:"创建时间",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:a.createTime,placement:"right-start"}},[i("el-button",{staticStyle:{border:"none",outline:"none"}},[e._v(e._s(e.dateTimeFormat(a.createTime))+" "),i("i",{staticClass:"el-icon-info"})])],1)]}}])}),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[i("el-dropdown",{staticStyle:{cursor:"pointer"},attrs:{placement:"bottom-start"}},[i("span",{staticClass:"el-dropdown-link"},[i("svg-icon",{attrs:{"icon-class":"3points-vertical"}})],1),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{nativeOn:{click:function(t){return e.showDeviceDetail(a.name)}}},[e._v("查看")]),i("el-dropdown-item",{nativeOn:{click:function(t){return e.deleteDeviceView(a.name)}}},[e._v("删除")]),i("el-dropdown-item",{nativeOn:{click:function(t){return e.updateDeviceView(a.name)}}},[e._v("状态同步")]),i("el-dropdown-item",{nativeOn:{click:function(t){return e.updateDeviceViewV2(a.name)}}},[e._v("状态同步v2")])],1)],1)]}}])})],1),i("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("span",[e._v("删除设备后无法恢复，确定删除？")]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.deleteDevice}},[e._v("确 定")])],1)]),i("el-dialog",{attrs:{title:"设备详情",visible:e.dialogVisible2detail,width:"30%"},on:{"update:visible":function(t){e.dialogVisible2detail=t}}},[i("pre",[e._v("      "+e._s(e.detailContent)+"\n    ")])]),i("el-dialog",{attrs:{title:"设备状态同步",visible:e.dialogVisible2status,width:"40%"},on:{"update:visible":function(t){e.dialogVisible2status=t}}},[i("update-device-dialog")],1),i("el-dialog",{attrs:{title:"设备状态同步V2",visible:e.dialogVisible2statusV2,width:"65%"},on:{"update:visible":function(t){e.dialogVisible2statusV2=t}}},[i("update-device-dialog-v2")],1),i("el-dialog",{attrs:{title:"创建设备实例",visible:e.dialogVisible2create,width:"30%"},on:{"update:visible":function(t){e.dialogVisible2create=t}}},[i("create-device-dialog",{on:{reload:e.reload}})],1)],1)},n=[],s=(i("e9c4"),i("d3b7"),i("159b"),i("b0c0"),i("3a3d")),l=i("ed08"),o=i("5c96"),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",e._l(e.twins,(function(t,a){return i("el-row",{key:a},[i("el-col",{attrs:{span:7}},[i("el-row",{staticStyle:{"text-align":"center"}},[i("el-col",{staticStyle:{"line-height":"30px"},attrs:{span:8}},[e._v(" 字段名称： ")]),i("el-col",{attrs:{span:16}},[i("el-input",{attrs:{disabled:!0},model:{value:t.propertyName,callback:function(i){e.$set(t,"propertyName",i)},expression:"item.propertyName"}})],1)],1)],1),i("el-col",{attrs:{span:7}},[i("el-row",{staticStyle:{"text-align":"center"}},[i("el-col",{staticStyle:{"line-height":"30px"},attrs:{span:8}},[e._v(" 上报值： ")]),i("el-col",{attrs:{span:16}},[i("el-input",{attrs:{disabled:!0},model:{value:t.reported.value,callback:function(i){e.$set(t.reported,"value",i)},expression:"item.reported.value"}})],1)],1)],1),i("el-col",{staticStyle:{"padding-left":"10px","text-align":"center"},attrs:{span:7}},[i("el-row",[i("el-col",{staticStyle:{"line-height":"30px"},attrs:{span:8}},[e._v(" 期望值： ")]),i("el-col",{attrs:{span:16}},[i("el-input",{model:{value:t.desired.value,callback:function(i){e.$set(t.desired,"value",i)},expression:"item.desired.value"}})],1)],1)],1),i("el-col",{staticStyle:{"text-align":"center","line-height":"40px"},attrs:{span:3}},[i("i",{staticClass:"el-icon-refresh",on:{click:function(t){return e.syncDeviceStatus(a)}}})])],1)})),1)},c=[],u={name:"UpdateDeviceDialog",data:function(){return{twins:null}},created:function(){this.init()},methods:{init:function(){var e=this;this.$store.dispatch("edge-device/getDeviceItem").then((function(t){e.twins=t.status.twins}))},syncDeviceStatus:function(e){var t=this.twins[e],i={};i[t["propertyName"]]=t["desired"]["value"],console.log(i);var a={desired:i};this.$store.dispatch("edge-device/updateDevice",a).then((function(e){Object(o["Message"])({message:"设备属性"+t["propertyName"]+"状态更新成功",type:"success",duration:5e3})}))}}},d=u,p=(i("2eb5"),i("2877")),v=Object(p["a"])(d,r,c,!1,null,"4d41cae1",null),f=v.exports,m=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-row",{staticStyle:{"margin-bottom":"10px"}},[i("el-col",{attrs:{span:7}},[i("el-row",[i("el-col",{staticStyle:{"line-height":"30px","text-align":"center"},attrs:{span:8}},[i("strong",[e._v("模型版本：")])]),i("el-col",{attrs:{span:16}},[i("el-select",{attrs:{placeholder:"请选择AI模型"},on:{change:e.changeValue},model:{value:e.modeInfo.value,callback:function(t){e.$set(e.modeInfo,"value",t)},expression:"modeInfo.value"}},e._l(e.modeInfo.options,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1)],1),e._l(e.twins,(function(t,a){return i("el-row",{key:a},[i("el-col",{attrs:{span:7}},[i("el-row",{staticStyle:{"text-align":"center"}},[i("el-col",{staticStyle:{"line-height":"30px"},attrs:{span:8}},[e._v(" 字段名称： ")]),i("el-col",{attrs:{span:16}},[i("el-input",{attrs:{disabled:!0},model:{value:t.propertyName,callback:function(i){e.$set(t,"propertyName",i)},expression:"item.propertyName"}})],1)],1)],1),i("el-col",{attrs:{span:7}},[i("el-row",{staticStyle:{"text-align":"center"}},[i("el-col",{staticStyle:{"line-height":"30px"},attrs:{span:6}},[e._v(" 上报值： ")]),i("el-col",{attrs:{span:18}},[i("el-input",{attrs:{disabled:!0},model:{value:t.reported.value,callback:function(i){e.$set(t.reported,"value",i)},expression:"item.reported.value"}})],1)],1)],1),i("el-col",{staticStyle:{"padding-left":"10px","text-align":"center"},attrs:{span:7}},[i("el-row",[i("el-col",{staticStyle:{"line-height":"30px"},attrs:{span:6}},[e._v(" 期望值： ")]),i("el-col",{attrs:{span:18}},[i("el-input",{model:{value:t.desired.value,callback:function(i){e.$set(t.desired,"value",i)},expression:"item.desired.value"}})],1)],1)],1),i("el-col",{staticStyle:{"text-align":"center","line-height":"40px"},attrs:{span:3}},[i("i",{staticClass:"el-icon-refresh",on:{click:function(t){return e.syncDeviceStatus(a)}}})])],1)})),i("el-row",{staticStyle:{"text-align":"center","margin-top":"10px"}},[i("el-button",{attrs:{type:"primary"},on:{click:e.syncDeviceStatusAll}},[e._v("一键同步所有字段")])],1)],2)},h=[],g={name:"UpdateDeviceDialogV2",data:function(){return{modeInfo:{options:[],value:""},twins:null}},created:function(){this.init()},methods:{changeValue:function(e){var t=this;this.$store.dispatch("edge-aimodel/getAiModelItem",e).then((function(e){t.twins.forEach((function(t,i){t.desired.value=e[t.propertyName]}))}))},init:function(){var e=this;this.$store.dispatch("edge-device/getDeviceItem").then((function(t){e.twins=t.status.twins})),this.$store.dispatch("edge-aimodel/getAiModelList").then((function(t){t.forEach((function(t,i){e.modeInfo.options.push(t.version)}))}))},syncDeviceStatusAll:function(){var e={};this.twins.forEach((function(t,i){e[t["propertyName"]]=t["desired"]["value"]}));var t={desired:e};this.$store.dispatch("edge-device/updateDevice",t).then((function(e){Object(o["Message"])({message:"设备状态更新成功",type:"success",duration:5e3})}))},syncDeviceStatus:function(e){var t=this.twins[e],i={};i[t["propertyName"]]=t["desired"]["value"];var a={desired:i};this.$store.dispatch("edge-device/updateDevice",a).then((function(e){Object(o["Message"])({message:"设备属性"+t["propertyName"]+"状态更新成功",type:"success",duration:5e3})}))}}},b=g,y=(i("9990"),Object(p["a"])(b,m,h,!1,null,"3f2b6200",null)),w=y.exports,D=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-form",{ref:"form",attrs:{model:e.form}},[e._l(e.form.properties,(function(t,a){return i("el-form-item",{key:a,attrs:{rules:t.rules,prop:"properties["+a+"].value"}},[i("span",{attrs:{slot:"label"},slot:"label"},[e._v(" "+e._s(t.label.title)+" ")]),"text"==t.type?i("el-input",{attrs:{placeholder:t.placeholder},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}}):"options"==t.type?i("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.placeholder},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}},e._l(t.options,(function(e){return i("el-option",{key:e,attrs:{label:e,value:e}})})),1):i("el-input",{attrs:{type:"textarea"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"item.value"}})],1)})),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("立即创建")])],1)],2)],1)},_=[],V={name:"CreateDeviceDialog",data:function(){return{form:{properties:[{name:"name",type:"text",label:{title:"设备名称",desc:"设备名称"},value:"",rules:[{required:!0,message:"请输入设备名称",trigger:"blur"}],placeholder:"请输入设备名称"},{name:"dm_name",type:"options",label:{title:"设备模板",desc:"设备模板"},value:"",options:[],rules:[{required:!0,message:"请选择设备模板",trigger:"blur"}],placeholder:"请选择设备模板"},{name:"node_name",type:"options",label:{title:"绑定节点",desc:"绑定节点"},value:"",options:[],rules:[{required:!0,message:"请选择绑定节点",trigger:"blur"}],placeholder:"请选择绑定节点"}]}}},created:function(){this.init()},methods:{init:function(){this.getNodeList(),this.getDmList()},getNodeList:function(){var e=this;this.$store.dispatch("edge-node/getNodeList").then((function(t){e.form.properties.forEach((function(e,i){"node_name"===e.name&&t.forEach((function(t,i){e.options.push(t.metadata.name)}))}))}))},getDmList:function(){var e=this;this.$store.dispatch("edge-device/getDeviceModelList").then((function(t){e.form.properties.forEach((function(e,i){"dm_name"===e.name&&t.forEach((function(t,i){e.options.push(t.metadata.name)}))}))}))},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;var i={};t.form.properties.forEach((function(e,t){try{i[e["name"]]=JSON.parse(e["value"])}catch(a){i[e["name"]]=e["value"]}})),t.$store.dispatch("edge-device/createDevice",i).then((function(e){Object(o["Message"])({message:"设备创建成功",type:"success",duration:5e3}),t.$emit("reload")}))}))}}},x=V,S=Object(p["a"])(x,D,_,!1,null,"12d2c748",null),k=S.exports,$={name:"DeviceInstance",components:{UpdateDeviceDialog:f,UpdateDeviceDialogV2:w,CreateDeviceDialog:k},data:function(){return{dialogVisible2detail:!1,dialogVisible:!1,dialogVisible2statusV2:!1,dialogVisible2create:!1,dialogVisible2status:!1,list:null,detailContent:"",twins:null}},created:function(){this.getList()},methods:{dateTimeFormat:l["b"],reload:function(){this.dialogVisible2create=!1,this.getList()},createDeviceView:function(){this.dialogVisible2create=!0},updateDeviceView:function(e){this.$store.dispatch("edge-device/setDeviceName",e),this.dialogVisible2status=!0},updateDeviceViewV2:function(e){this.$store.dispatch("edge-device/setDeviceName",e),this.dialogVisible2statusV2=!0},showDeviceDetail:function(e){var t=this;this.dialogVisible2detail=!0,this.$store.dispatch("edge-device/setDeviceName",e),this.$store.dispatch("edge-device/getDeviceItem").then((function(e){t.detailContent=JSON.stringify(e,null,4)}))},deleteDeviceView:function(e){this.$store.dispatch("edge-device/setDeviceName",e),this.dialogVisible=!0},deleteDevice:function(){var e=this;this.$store.dispatch("edge-device/deleteDevice").then((function(){Object(o["Message"])({message:"删除设备成功",type:"success",duration:5e3}),e.dialogVisible=!1,e.getList()}))},getList:function(){var e=this;Object(s["e"])().then((function(t){var i=[];t.forEach((function(e,t){i.push({name:e.metadata.name,createTime:e.metadata.creationTimestamp})})),e.list=i}))}}},N=$,O=Object(p["a"])(N,a,n,!1,null,"bd9a9efe",null);t["default"]=O.exports},b0ca:function(e,t,i){},c84a:function(e,t,i){},e9c4:function(e,t,i){var a=i("23e7"),n=i("d066"),s=i("d039"),l=n("JSON","stringify"),o=/[\uD800-\uDFFF]/g,r=/^[\uD800-\uDBFF]$/,c=/^[\uDC00-\uDFFF]$/,u=function(e,t,i){var a=i.charAt(t-1),n=i.charAt(t+1);return r.test(e)&&!c.test(n)||c.test(e)&&!r.test(a)?"\\u"+e.charCodeAt(0).toString(16):e},d=s((function(){return'"\\udf06\\ud834"'!==l("\udf06\ud834")||'"\\udead"'!==l("\udead")}));l&&a({target:"JSON",stat:!0,forced:d},{stringify:function(e,t,i){var a=l.apply(null,arguments);return"string"==typeof a?a.replace(o,u):a}})}}]);